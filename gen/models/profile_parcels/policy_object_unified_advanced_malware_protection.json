{
    "request": {
        "$schema": "http://json-schema.org/draft/2019-09/schema",
        "$id": "https://cisco.com/schema/profileparcel/sdwan/policy-object/unified/advanced-malware-protection/post/request_schema.json",
        "title": "advanced-malware-protection Parcel Schema",
        "description": "advanced-malware-protection profile parcel schema for POST request",
        "type": "object",
        "properties": {
            "name": {
                "minLength": 1,
                "maxLength": 32,
                "pattern": "^[^&<>! \"]+$",
                "type": "string"
            },
            "description": {
                "type": "string"
            },
            "data": {
                "type": "object",
                "minProperties": 1,
                "properties": {
                    "matchAllVpn": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "const": true
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileReputationCloudServer": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "enum": [
                                            "nam",
                                            "eur",
                                            "apjc"
                                        ],
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileReputationEstServer": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "enum": [
                                            "nam",
                                            "eur",
                                            "apjc"
                                        ],
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileReputationAlert": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "enum": [
                                            "critical",
                                            "warning",
                                            "info"
                                        ],
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileAnalysisEnabled": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "type": "boolean"
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileAnalysisCloudServer": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "enum": [
                                            "nam",
                                            "eur"
                                        ],
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileAnalysisFileTypes": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "type": "array",
                                        "uniqueItems": true,
                                        "minItems": 1,
                                        "items": {
                                            "type": "string"
                                        }
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    },
                    "fileAnalysisAlert": {
                        "oneOf": [
                            {
                                "properties": {
                                    "optionType": {
                                        "type": "string",
                                        "enum": [
                                            "global"
                                        ]
                                    },
                                    "value": {
                                        "enum": [
                                            "critical",
                                            "warning",
                                            "info"
                                        ],
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "optionType",
                                    "value"
                                ],
                                "additionalProperties": false
                            }
                        ]
                    }
                },
                "required": [
                    "matchAllVpn",
                    "fileReputationCloudServer",
                    "fileReputationEstServer",
                    "fileReputationAlert",
                    "fileAnalysisEnabled"
                ],
                "additionalProperties": false
            },
            "documentation": {
                "description": "This is the documentation for POST request schema for advanced-malware-protection profile parcel",
                "details-1": "variable name should be present with given format as specified in schema if optionType value is variable",
                "details-2": "variable name should not be present if optionType value is NOT variable",
                "details-3": "when option Type is global,  value should be present with given format/restrictions as specified in schema",
                "details-4": "when option Type is default, value should be present with given default value as specified in schema",
                "examples": [
                    {
                        "name": "AMP1",
                        "description": "advancedMalwareProtection",
                        "data": {
                            "matchAllVpn": {
                                "optionType": "global",
                                "value": true
                            },
                            "fileReputationCloudServer": {
                                "optionType": "global",
                                "value": "nam"
                            },
                            "fileReputationEstServer": {
                                "optionType": "global",
                                "value": "nam"
                            },
                            "fileReputationAlert": {
                                "optionType": "global",
                                "value": "critical"
                            },
                            "fileAnalysisCloudServer": {
                                "optionType": "global",
                                "value": "nam"
                            },
                            "fileAnalysisFileTypes": {
                                "optionType": "global",
                                "value": [
                                    "pdf",
                                    "jpg"
                                ]
                            },
                            "fileAnalysisAlert": {
                                "optionType": "global",
                                "value": "critical"
                            },
                            "fileAnalysisEnabled": {
                                "optionType": "global",
                                "value": true
                            }
                        }
                    },
                    {
                        "name": "AMP1",
                        "description": "advancedMalwareProtection",
                        "data": {
                            "matchAllVpn": {
                                "optionType": "global",
                                "value": true
                            },
                            "fileReputationCloudServer": {
                                "optionType": "global",
                                "value": "nam"
                            },
                            "fileReputationEstServer": {
                                "optionType": "global",
                                "value": "nam"
                            },
                            "fileReputationAlert": {
                                "optionType": "global",
                                "value": "critical"
                            },
                            "fileAnalysisEnabled": {
                                "optionType": "global",
                                "value": false
                            }
                        }
                    }
                ]
            }
        },
        "required": [
            "name",
            "description",
            "data"
        ],
        "not": {
            "required": [
                "documentation"
            ]
        },
        "allOf": [
            {
                "if": {
                    "properties": {
                        "data": {
                            "properties": {
                                "fileAnalysisEnabled": {
                                    "properties": {
                                        "value": {
                                            "enum": [
                                                true
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "then": {
                    "properties": {
                        "data": {
                            "required": [
                                "fileAnalysisCloudServer",
                                "fileAnalysisFileTypes",
                                "fileAnalysisAlert"
                            ]
                        }
                    }
                },
                "else": {
                    "properties": {
                        "data": {
                            "not": {
                                "required": [
                                    "fileAnalysisCloudServer",
                                    "fileAnalysisFileTypes",
                                    "fileAnalysisAlert"
                                ]
                            }
                        }
                    }
                }
            }
        ],
        "additionalProperties": false
    }
}