{
  "request": {
    "$schema": "http://json-schema.org/draft/2019-09/schema",
    "$id": "https://cisco.com/schema/profileparcel/sdwan/embedded-security/policy/post/request_schema.json",
    "title": "Policy Feature Schema",
    "description": "Policy profile Feature schema for POST request",
    "type": "object",
    "properties": {
      "name": {
        "type": "string",
        "pattern": "^[^&<>! \"]+$",
        "minLength": 1,
        "maxLength": 128
      },
      "description": {
        "type": "string"
      },
      "data": {
        "type": "object",
        "properties": {
          "assembly": {
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
              "type": "object",
              "properties": {
                "advancedInspectionProfile": {
                  "type": "object",
                  "properties": {
                    "refId": {
                      "type": "object",
                      "properties": {
                        "optionType": {
                          "type": "string",
                          "enum": [
                            "global"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "pattern": "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
                        }
                      },
                      "required": [
                        "optionType",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "refId"
                  ],
                  "additionalProperties": false
                },
                "sslDecryption": {
                  "type": "object",
                  "properties": {
                    "refId": {
                      "type": "object",
                      "properties": {
                        "optionType": {
                          "type": "string",
                          "enum": [
                            "global"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "pattern": "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
                        }
                      },
                      "required": [
                        "optionType",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "refId"
                  ],
                  "additionalProperties": false
                },
                "ngfirewall": {
                  "type": "object",
                  "properties": {
                    "refId": {
                      "type": "object",
                      "properties": {
                        "optionType": {
                          "type": "string",
                          "enum": [
                            "global"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "pattern": "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
                        }
                      },
                      "required": [
                        "optionType",
                        "value"
                      ],
                      "additionalProperties": false
                    },
                    "entries": {
                      "type": "array",
                      "uniqueItems": true,
                      "minItems": 1,
                      "items": {
                        "type": "object",
                        "properties": {
                          "srcZone": {
                            "oneOf": [
                              {
                                "type": "object",
                                "properties": {
                                  "refId": {
                                    "type": "object",
                                    "properties": {
                                      "optionType": {
                                        "type": "string",
                                        "enum": [
                                          "global"
                                        ]
                                      },
                                      "value": {
                                        "type": "string",
                                        "pattern": "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
                                      }
                                    },
                                    "required": [
                                      "optionType",
                                      "value"
                                    ],
                                    "additionalProperties": false
                                  }
                                },
                                "required": [
                                  "refId"
                                ],
                                "additionalProperties": false
                              },
                              {
                                "type": "object",
                                "properties": {
                                  "optionType": {
                                    "type": "string",
                                    "enum": [
                                      "global"
                                    ]
                                  },
                                  "value": {
                                    "enum": [
                                      "self",
                                      "default",
                                      "untrusted"
                                    ],
                                    "type": "string"
                                  }
                                },
                                "required": [
                                  "optionType",
                                  "value"
                                ],
                                "additionalProperties": false
                              }
                            ]
                          },
                          "dstZone": {
                            "oneOf": [
                              {
                                "type": "object",
                                "properties": {
                                  "refId": {
                                    "type": "object",
                                    "properties": {
                                      "optionType": {
                                        "type": "string",
                                        "enum": [
                                          "global"
                                        ]
                                      },
                                      "value": {
                                        "type": "string",
                                        "pattern": "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
                                      }
                                    },
                                    "required": [
                                      "optionType",
                                      "value"
                                    ],
                                    "additionalProperties": false
                                  }
                                },
                                "required": [
                                  "refId"
                                ],
                                "additionalProperties": false
                              },
                              {
                                "type": "object",
                                "properties": {
                                  "optionType": {
                                    "type": "string",
                                    "enum": [
                                      "global"
                                    ]
                                  },
                                  "value": {
                                    "enum": [
                                      "self",
                                      "default",
                                      "untrusted"
                                    ],
                                    "type": "string"
                                  }
                                },
                                "required": [
                                  "optionType",
                                  "value"
                                ],
                                "additionalProperties": false
                              }
                            ]
                          }
                        },
                        "required": [
                          "srcZone",
                          "dstZone"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "refId",
                    "entries"
                  ],
                  "additionalProperties": false
                }
              },
              "anyOf": [
                {
                  "required": [
                    "sslDecryption"
                  ]
                },
                {
                  "required": [
                    "ngfirewall"
                  ]
                },
                {
                  "required": [
                    "advancedInspectionProfile"
                  ]
                }
              ],
              "additionalProperties": false
            }
          },
          "settings": {
            "type": "object",
            "minProperties": 0,
            "properties": {
              "tcpSynFloodLimit": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^([1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[01][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[01][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])$"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "maxIncompleteTcpLimit": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^([1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[01][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[01][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])$"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "maxIncompleteUdpLimit": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^([1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[01][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[01][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])$"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "maxIncompleteIcmpLimit": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^([1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[01][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[01][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])$"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "auditTrail": {
                "description": "Setting can be string 'on' or missing for off",
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "enum": [
                          "on"
                        ],
                        "type": "string"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "unifiedLogging": {
                "description": "Setting can be string 'on' or missing for off",
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "enum": [
                          "on"
                        ],
                        "type": "string"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "sessionReclassifyAllow": {
                "description": "Setting can be string 'on' or missing for off",
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "enum": [
                          "on"
                        ],
                        "type": "string"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "icmpUnreachableAllow": {
                "description": "Setting can be string 'on' or missing for off",
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "enum": [
                          "on"
                        ],
                        "type": "string"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "failureMode": {
                "type": "object",
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "enum": [
                          "close",
                          "open"
                        ],
                        "type": "string"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "securityLogging": {
                "description": "HSL and UTD syslog, pulled from network settings page",
                "properties": {
                  "optionType": {
                    "type": "string",
                    "enum": [
                      "network-settings"
                    ]
                  },
                  "value": {
                    "type": "boolean"
                  }
                },
                "required": [
                  "optionType",
                  "value"
                ],
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          "appHosting": {
            "type": "object",
            "properties": {
              "nat": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "type": "boolean"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  },
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "variable"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^\\{\\{[.\\/\\[\\]a-zA-Z0-9_-]+\\}\\}$",
                        "minLength": 1,
                        "maxLength": 128
                      },
                      "default": {
                        "type": "boolean"
                      },
                      "description": {
                        "minLength": 1,
                        "type": "string",
                        "maxLength": 128
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "databaseUrl": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "type": "boolean"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  },
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "variable"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^\\{\\{[.\\/\\[\\]a-zA-Z0-9_-]+\\}\\}$",
                        "minLength": 1,
                        "maxLength": 128
                      },
                      "default": {
                        "type": "boolean"
                      },
                      "description": {
                        "minLength": 1,
                        "type": "string",
                        "maxLength": 128
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              },
              "resourceProfile": {
                "oneOf": [
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "global"
                        ]
                      },
                      "value": {
                        "enum": [
                          "low",
                          "medium",
                          "high"
                        ],
                        "type": "string"
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  },
                  {
                    "properties": {
                      "optionType": {
                        "type": "string",
                        "enum": [
                          "variable"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "pattern": "^\\{\\{[.\\/\\[\\]a-zA-Z0-9_-]+\\}\\}$",
                        "minLength": 1,
                        "maxLength": 128
                      },
                      "default": {
                        "enum": [
                          "low",
                          "medium",
                          "high"
                        ],
                        "type": "string"
                      },
                      "description": {
                        "minLength": 1,
                        "type": "string",
                        "maxLength": 128
                      }
                    },
                    "required": [
                      "optionType",
                      "value"
                    ],
                    "additionalProperties": false
                  }
                ]
              }
            },
            "required": [
              "nat",
              "databaseUrl",
              "resourceProfile"
            ],
            "additionalProperties": false
          }
        },
        "required": [
          "assembly"
        ],
        "additionalProperties": false
      },
      "documentation": {
        "description": "This is the documentation for POST request schema for Policy profile Feature",
        "details-1": "variable name should be present with given format as specified in schema if optionType value is variable",
        "details-2": "variable name should not be present if optionType value is NOT variable",
        "details-3": "when option Type is global,  value should be present with given format/restrictions as specified in schema",
        "details-4": "when option Type is default, value should be present with given default value as specified in schema",
        "examples": [
          {
            "data": {
              "assembly": [
                {
                  "advancedInspectionProfile": {
                    "refId": {
                      "optionType": "global",
                      "value": "0c216de0-367e-40d9-9f6f-f0a7bceb3403"
                    }
                  }
                },
                {
                  "sslDecryption": {
                    "refId": {
                      "optionType": "global",
                      "value": "6a178fe9-bead-4319-8b37-2f5a7ba14592"
                    }
                  }
                },
                {
                  "ngfirewall": {
                    "refId": {
                      "optionType": "global",
                      "value": "52324806-f444-41a8-8837-7a40cb19f4e3"
                    },
                    "entries": [
                      {
                        "srcZone": {
                          "refId": {
                            "optionType": "global",
                            "value": "3f2cc386-01ad-43d6-85cd-9657571525f4"
                          }
                        },
                        "dstZone": {
                          "optionType": "global",
                          "value": "self"
                        }
                      }
                    ]
                  }
                }
              ],
              "settings": {
                "tcpSynFloodLimit": {
                  "optionType": "global",
                  "value": "11"
                },
                "maxIncompleteTcpLimit": {
                  "optionType": "global",
                  "value": "12"
                },
                "maxIncompleteUdpLimit": {
                  "optionType": "global",
                  "value": "13"
                },
                "maxIncompleteIcmpLimit": {
                  "optionType": "global",
                  "value": "14"
                },
                "auditTrail": {
                  "optionType": "global",
                  "value": "on"
                },
                "unifiedLogging": {
                  "optionType": "global",
                  "value": "on"
                },
                "sessionReclassifyAllow": {
                  "optionType": "global",
                  "value": "on"
                },
                "icmpUnreachableAllow": {
                  "optionType": "global",
                  "value": "on"
                },
                "securityLogging": {
                  "optionType": "network-settings",
                  "value": true
                },
                "failureMode": {
                  "optionType": "global",
                  "value": "open"
                }
              },
              "appHosting": {
                "nat": {
                  "optionType": "global",
                  "value": true
                },
                "databaseUrl": {
                  "optionType": "global",
                  "value": false
                },
                "resourceProfile": {
                  "optionType": "variable",
                  "value": "{{testVarName}}"
                }
              }
            },
            "description": "test",
            "name": "PolicyFeatureGlobalDefault"
          }
        ]
      },
      "metadata": {
        "minVManageVersion": "20.15.1"
      }
    },
    "required": [
      "name",
      "description",
      "data"
    ],
    "not": {
      "required": [
        "documentation",
        "metadata"
      ]
    },
    "additionalProperties": false
  }
}