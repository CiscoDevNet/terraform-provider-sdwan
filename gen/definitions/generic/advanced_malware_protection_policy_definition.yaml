---
name: Advanced Malware Protection Policy Definition
rest_endpoint: /template/policy/definition/advancedMalwareProtection/
has_version: true
id_attribute: definitionId
get_before_delete: true
doc_category: (Classic) Security Policies
attributes:
  - model_name: type
    type: String
    value: advancedMalwareProtection
  - model_name: name
    tf_name: name
    type: String
    mandatory: true
    description: The name of the policy definition
    example: Example
  - model_name: description
    tf_name: description
    type: String
    mandatory: true
    description: The description of the policy definition
    example: My description
  - model_name: mode
    tf_name: mode
    type: String
    enum_values: [security, unified]
    default_value: security
    description: The policy mode
    example: security
  - model_name: matchAllVpn
    data_path: [definition]
    tf_name: match_all_vpn
    type: Bool
    description: Should match all VPNs
    example: false
  - model_name: targetVpns
    data_path: [definition]
    tf_name: target_vpns
    type: Set
    element_type: String
    description: List of VPN IDs
    example: 1
  - model_name: fileReputationAlert
    data_path: [definition]
    tf_name: alert_log_level
    type: String
    enum_values: [critical, warning, info]
    description: File reputation alerts Log level
    example: critical
  - model_name: fileReputationCloudServer
    data_path: [definition]
    tf_name: amp_cloud_region
    type: String
    enum_values: [nam, eu, apjc]
    description: AMP Cloud Region
    example: apjc
  - model_name: fileReputationEstServer
    data_path: [definition]
    tf_name: amp_cloud_region_est_server
    type: String
    enum_values: [nam, eu, apjc]
    description: AMP Cloud Region
    example: apjc
  - model_name: fileAnalysisEnabled
    data_path: [definition]
    tf_name: file_analysis
    type: Bool
    description: Should file analysis be enabled
    example: false
  - model_name: fileAnalysisCloudServer
    data_path: [definition]
    tf_name: file_analysis_cloud_region
    type: String
    enum_values: [nam, eu]
    description: TG Cloud Region
    example: eu
    exclude_test: true
  - model_name: fileAnalysisAlert
    data_path: [definition]
    tf_name: file_analysis_alert_log_level
    type: String
    enum_values: [critical, warning, info]
    description: File analysis alerts Log level
    example: critical
    exclude_test: true
  - model_name: fileAnalysisFileTypes
    data_path: [definition]
    tf_name: file_analysis_file_types
    type: Set
    element_type: String
    description: List of file type
    example: pdf
    exclude_test: true
