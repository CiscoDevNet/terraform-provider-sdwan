---
# Manual resource - Modals toBody is manually configured to support sub interfaces and global NAT type pool
name: Service LAN VPN Interface Ethernet
rest_endpoint: /v1/feature-profile/sdwan/service/%v/lan/vpn/%s/interface/ethernet
minimum_version: 20.15.0
test_tags: [SDWAN_2015]
parcel_type: feature
doc_category: Features - Service
attributes:
  - tf_name: feature_profile_id
    reference: true
    type: String
    mandatory: true
    description: Feature Profile ID
    example: f6dd22c8-0b4f-496c-9a0b-6813d1f8b8ac
    test_value: sdwan_service_feature_profile.test.id
  - tf_name: service_lan_vpn_feature_id
    reference: true
    type: String
    mandatory: true
    description: Service LAN VPN Feature ID
    example: 140331f6-5418-4755-a059-13c77eb96037
    test_value: sdwan_service_lan_vpn_feature.test.id
  - model_name: shutdown
    example: false
  - model_name: interfaceName
    example: GigabitEthernet3
    minimum_test_value: '"GigabitEthernet3"'
  - model_name: description
    tf_name: interface_description
    example: LAN
  - model_name: portChannelInterface
    tf_name: port_channel_interface
    example: false
    exclude_test: true
  - tf_name: port_channel_mode
    type: String
    tf_only: true
    description: Port Channel Mode
    enum_values: [lacp, static]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
  - model_name: portChannelQosAggregate
    tf_name: port_channel_lacp_qos_aggregate
    data_path: [portChannel, mainInterface, lacpModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: lacp
  - model_name: loadBalance
    tf_name: port_channel_lacp_load_balance
    data_path: [portChannel, mainInterface, lacpModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: lacp
  - model_name: lacpFastSwitchover
    tf_name: port_channel_lacp_fast_switchover
    data_path: [portChannel, mainInterface, lacpModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: lacp
  - model_name: lacpMinBundle
    tf_name: port_channel_lacp_min_bundle
    data_path: [portChannel, mainInterface, lacpModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: lacp
  - model_name: lacpMaxBundle
    tf_name: port_channel_lacp_max_bundle
    data_path: [portChannel, mainInterface, lacpModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: lacp
  - model_name: portChannelMemberLinks
    tf_name: port_channel_lacp_member_links
    data_path: [portChannel, mainInterface, lacpModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: lacp
    attributes:
      - model_name: refId
        tf_name: interface_id
        data_path: [interface]
        id: true
        mandatory: true
      - model_name: lacpMode
        default_value: active
        default_value_present: true
      - model_name: lacpRate
      - model_name: lacpPortPriority
  - model_name: portChannelQosAggregate
    tf_name: port_channel_static_qos_aggregate
    data_path: [portChannel, mainInterface, staticModeMainInterface]
    exclude_test: true
    exclude_example: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: static
  - model_name: loadBalance
    tf_name: port_channel_static_load_balance
    data_path: [portChannel, mainInterface, staticModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: static
  - model_name: portChannelMemberLinks
    tf_name: port_channel_static_member_links
    data_path: [portChannel, mainInterface, staticModeMainInterface]
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: port_channel_mode
          value: static
    attributes:
      - model_name: refId
        tf_name: interface_id
        data_path: [interface]
        id: true
        mandatory: true
  - tf_name: port_channel_subinterface
    type: Bool
    exclude_test: true
    tf_only: true
    description: Port Channel Sub Interface on/off
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
  - model_name: primaryInterfaceName
    tf_name: port_channel_subinterface_primary_interface_name
    exclude_test: true
    data_path: [portChannel, subInterface]
    default_value: ""
    default_value_present: true
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
        - name: port_channel_subinterface
          value: true
          type: Bool
  - model_name: secondaryInterfaceName
    tf_name: port_channel_subinterface_secondary_interface_name
    exclude_test: true
    data_path: [portChannel, subInterface]
    default_value: ""
    default_value_present: true
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
        - name: port_channel_subinterface
          value: true
          type: Bool
  - model_name: portChannelMemberInterface
    tf_name: port_channel_member_interface
    example: false
    exclude_test: true
  - tf_name: ipv4_configuration_type
    type: String
    tf_only: true
    default_value: "dynamic"
    default_value_present: true
    description: IPv4 Configuration Type
    enum_values: [dynamic, static, none]
    example: static
    minimum_test_value: '"static"'
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: dynamicDhcpDistance
    tf_name: ipv4_dhcp_distance
    data_path: [intfIpAddress, dynamic]
    conditional_attribute:
      conditions:
        - name: ipv4_configuration_type
          value: dynamic
    exclude_test: true
    example: 1
    default_value: 1
    default_value_present: true
  - model_name: ipAddress
    tf_name: ipv4_address
    data_path: [intfIpAddress, static, staticIpV4AddressPrimary]
    conditional_attribute:
      conditions:
        - name: ipv4_configuration_type
          value: static
    example: 1.2.3.4
    minimum_test_value: '"1.2.3.4"'
  - model_name: subnetMask
    tf_name: ipv4_subnet_mask
    data_path: [intfIpAddress, static, staticIpV4AddressPrimary]
    conditional_attribute:
      conditions:
        - name: ipv4_configuration_type
          value: static
    example: 0.0.0.0
    minimum_test_value: '"0.0.0.0"'
  - model_name: staticIpV4AddressSecondary
    tf_name: ipv4_secondary_addresses
    data_path: [intfIpAddress, static]
    conditional_attribute:
      conditions:
        - name: ipv4_configuration_type
          value: static
    attributes:
    - model_name: ipAddress
      tf_name: address
      id: true
      example: 1.2.3.5
    - model_name: subnetMask
      example: 0.0.0.0
  - model_name: dhcpHelper
    tf_name: ipv4_dhcp_helper
    example: 1.2.3.4
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - tf_name: ipv6_configuration_type
    type: String
    tf_only: true
    default_value: "none"
    default_value_present: true
    description: IPv6 Configuration Type
    enum_values: [dynamic, static, none]
    example: static
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: dhcpClient
    tf_name: enable_dhcpv6
    data_path: [intfIpV6Address, dynamic]
    conditional_attribute:
      conditions:
        - name: ipv6_configuration_type
          value: dynamic
    exclude_test: true
    example: false
  - model_name: secondaryIpV6Address
    tf_name: ipv6_dhcp_secondary_addresses
    data_path: [intfIpV6Address, dynamic]
    conditional_attribute:
      conditions:
        - name: ipv6_configuration_type
          value: dynamic
    exclude_null: true
    exclude_test: true
    attributes:
    - model_name: address
      id: true
      example: 2001:0:0:1::0
  - model_name: address
    tf_name: ipv6_address
    data_path: [intfIpV6Address, static, primaryIpV6Address]
    conditional_attribute:
      conditions:
        - name: ipv6_configuration_type
          value: static
    exclude_test: true
    example: 2001:0:0:1::0
  - model_name: secondaryIpV6Address
    tf_name: ipv6_secondary_addresses
    data_path: [intfIpV6Address, static]
    conditional_attribute:
      conditions:
        - name: ipv6_configuration_type
          value: static
    exclude_null: true
    exclude_test: true
    attributes:
    - model_name: address
      id: true
      example: 2001:0:0:1::0
  - model_name: dhcpHelperV6
    tf_name: ipv6_dhcp_helpers
    data_path: [intfIpV6Address, static]
    conditional_attribute:
      conditions:
        - name: ipv6_configuration_type
          value: static
    exclude_null: true
    attributes:
    - model_name: ipAddress
      tf_name: address
      id: true
      example: 2001:0:0:1::0
    - model_name: vpn
      tf_name: dhcpv6_helper_vpn
      id: true
      example: 1
  - model_name: nat
    tf_name: ipv4_nat
    example: false
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: natType
    tf_name: ipv4_nat_type
    data_path: [natAttributesIpv4]
    type: String
    value: "pool"
    always_include: true
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: rangeStart
    tf_name: ipv4_nat_range_start
    data_path: [natAttributesIpv4, natPool]
    exclude_null: true
    # conditional_attribute: 
    #   name: Ipv4NatType
    #   value: pool
    example: 1.2.3.4
  - model_name: rangeEnd
    tf_name: ipv4_nat_range_end
    data_path: [natAttributesIpv4, natPool]
    exclude_null: true
    # conditional_attribute: 
    #   name: Ipv4NatType
    #   value: pool
    example: 4.5.6.7
  - model_name: prefixLength
    tf_name: ipv4_nat_prefix_length
    data_path: [natAttributesIpv4, natPool]
    exclude_null: true
    # conditional_attribute: 
    #   name: Ipv4NatType
    #   value: pool
    example: 1
  - model_name: overload
    tf_name: ipv4_nat_overload
    data_path: [natAttributesIpv4, natPool]
    exclude_null: true
    # conditional_attribute: 
    #   name: Ipv4NatType
    #   value: pool
    example: true
  - model_name: natLoopback
    tf_name: ipv4_nat_loopback
    data_path: [natAttributesIpv4]
    exclude_test: true
    exclude_null: true
    # conditional_attribute: 
    #   name: Ipv4NatType
    #   value: loopback
    example: 123
  - model_name: udpTimeout
    tf_name: ipv4_nat_udp_timeout
    data_path: [natAttributesIpv4]
    exclude_test: true
    example: 123
  - model_name: tcpTimeout
    tf_name: ipv4_nat_tcp_timeout
    data_path: [natAttributesIpv4]
    exclude_test: true
    example: 123
  - model_name: newStaticNat
    tf_name: static_nats
    data_path: [natAttributesIpv4]
    exclude_test: true
    attributes:
    - model_name: sourceIp
      id: true
      example: 1.2.3.4
    - model_name: translateIp
      id: true
      example: 2.3.4.5
    - model_name: staticNatDirection
      tf_name: direction
      id: true
      example: inside
    - model_name: sourceVpn
      id: true
      example: 0
  - model_name: natIpv6
    tf_name: ipv6_nat
    example: true
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: nat64
    tf_name: nat64
    data_path: [natAttributesIpv6]
    exclude_null: true
    example: false
  - model_name: shapingRate
    tf_name: acl_shaping_rate
    data_path: [aclQos]
    example: 12
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: refId
    tf_name: acl_ipv4_egress_policy_id
    data_path: [aclQos, ipv4AclEgress]
    optional: true
    exclude_test: true
    example: 1b270f6d-479b-47e3-ab0b-51bc6811a303
  - model_name: refId
    tf_name: acl_ipv4_ingress_policy_id
    data_path: [aclQos, ipv4AclIngress]
    optional: true
    exclude_test: true
    example: 1b270f6d-479b-47e3-ab0b-51bc6811a303
  - model_name: refId
    tf_name: acl_ipv6_egress_policy_id
    data_path: [aclQos, ipv6AclEgress]
    optional: true
    exclude_test: true
    example: 1b270f6d-479b-47e3-ab0b-51bc6811a303
  - model_name: refId
    tf_name: acl_ipv6_ingress_policy_id
    data_path: [aclQos, ipv6AclIngress]
    optional: true
    exclude_test: true
    example: 1b270f6d-479b-47e3-ab0b-51bc6811a303
  - model_name: vrrpIpv6
    tf_name: ipv6_vrrps
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
    attributes:
    - model_name: groupId
      id: true
      example: 1
    - model_name: priority
      example: 100
    - model_name: timer
      example: 1000
    - model_name: trackOmp
      example: false
    - model_name: ipv6
      tf_name: ipv6_addresses
      attributes:
      - model_name: ipv6LinkLocal
        tf_name: link_local_address
        id: true
        example: 1::1
      - model_name: prefix
        tf_name: global_address
        example: 1::1/24
    - model_name: followDualRouterHAAvailability
      tf_name: follow_dual_router_high_availability
      example: false
    - model_name: minPreemptDelay
      example: 60
  - model_name: vrrp
    tf_name: ipv4_vrrps
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
    attributes:
    - model_name: group_id
      tf_name: group_id
      id: true
      example: 1
    - model_name: priority
      example: 100
    - model_name: timer
      example: 1000
    - model_name: trackOmp
      example: false
    - model_name: ipAddress
      tf_name: address
      example: 1.2.3.4
    - model_name: ipAddressSecondary
      tf_name: secondary_addresses
      attributes:
      - model_name: ipAddress
        tf_name: address
        id: true
        example: 2.3.4.5
      - model_name: subnetMask
        example: 0.0.0.0
    - model_name: tlocPrefChange
      tf_name: tloc_prefix_change
      example: true
    - model_name: tlocPrefChangeValue
      example: 100
    - model_name: trackingObject
      tf_name: tracking_objects
      attributes:
      - model_name: refId
        tf_name: tracker_id
        data_path: [trackerId]
        id: true
        example: 1b270f6d-479b-47e3-ab0b-51bc6811a303
        test_value: sdwan_service_tracker_feature.test.id
      - model_name: trackerAction
        example: Decrement
      - model_name: decrementValue
        example: 100
    - model_name: followDualRouterHAAvailability
      tf_name: follow_dual_router_high_availability
      example: false
    - model_name: minPreemptDelay
      example: 60
  - model_name: arp
    tf_name: arps
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
    attributes:
    - model_name: ipAddress 
      id: true
      example: 1.2.3.4
    - model_name: macAddress
      id: true
      example: 00-B0-D0-63-C2-26
  - model_name: enableSGTPropogation
    tf_name: trustsec_enable_sgt_propogation
    data_path: [trustsec]
    example: false
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: propogate
    tf_name: trustsec_propogate
    data_path: [trustsec]
    example: true
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: securityGroupTag
    tf_name: trustsec_security_group_tag
    data_path: [trustsec]
    example: 123
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: enableEnforcedPropogation
    tf_name: trustsec_enable_enforced_propogation
    data_path: [trustsec]
    example: false
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: enforcedSecurityGroupTag
    tf_name: trustsec_enforced_security_group_tag
    data_path: [trustsec]
    example: 1234
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: duplex
    data_path: [advanced]
    example: full
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
          negate: true
  - model_name: macAddress
    data_path: [advanced]
    example: 00-B0-D0-63-C2-26
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
        - name: port_channel_interface
          value: true
          type: Bool
          negate: true
  - model_name: ipMtu
    data_path: [advanced]
    example: 1500
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: intrfMtu
    tf_name: interface_mtu
    data_path: [advanced]
    example: 1500
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: tcpMss
    data_path: [advanced]
    example: 500
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: speed
    data_path: [advanced]
    example: 1000
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
          negate: true
  - model_name: arpTimeout
    data_path: [advanced]
    example: 1200
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: autonegotiate
    data_path: [advanced]
    example: false
  - model_name: mediaType
    data_path: [advanced]
    example: auto-select
    conditional_attribute:
      conditions:
        - name: port_channel_interface
          value: true
          type: Bool
          negate: true
  - model_name: loadInterval
    data_path: [advanced]
    example: 30
  - model_name: icmpRedirectDisable
    data_path: [advanced]
    example: true
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: xconnect
    data_path: [advanced]
    example: 1
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true
  - model_name: ipDirectedBroadcast
    data_path: [advanced]
    example: false
    conditional_attribute:
      conditions:
        - name: port_channel_member_interface
          value: true
          type: Bool
          negate: true

test_prerequisites: |
  resource "sdwan_service_feature_profile" "test" {
    name = "TF_TEST"
    description = "Terraform test"
  }

  resource "sdwan_service_lan_vpn_feature" "test" {
    name = "TF_TEST_SLAN"
    feature_profile_id = sdwan_service_feature_profile.test.id
  }

  resource "sdwan_service_tracker_feature" "test" {
    name                  = "TF_TEST_TRACKER"
    description           = "Terraform test"
    feature_profile_id    = sdwan_service_feature_profile.test.id
    tracker_name          = "TRACKER_1"
    endpoint_api_url      = "google.com"
    endpoint_dns_name     = "google.com"
    endpoint_ip           = "1.2.3.4"
    interval              = 30
    multiplier            = 3
    threshold             = 300
    endpoint_tracker_type = "static-route"
    tracker_type          = "endpoint"
  }