---
name: Transport WAN VPN Interface GRE
rest_endpoint: /v1/feature-profile/sdwan/transport/%v/wan/vpn/%s/interface/gre
minimum_version: 20.15.0
test_tags: [SDWAN_2015]
parcel_type: feature
doc_category: Features - Transport
attributes:
  - tf_name: feature_profile_id
    reference: true
    type: String
    mandatory: true
    description: Feature Profile ID
    example: f6dd22c8-0b4f-496c-9a0b-6813d1f8b8ac
    test_value: sdwan_transport_feature_profile.test.id
  - tf_name: transport_wan_vpn_feature_id
    reference: true
    type: String
    mandatory: true
    description: Transport WAN VPN Feature ID
    example: 140331f6-5418-4755-a059-13c77eb96037
    test_value: sdwan_transport_wan_vpn_feature.test.id
  - model_name: ifName
    tf_name: interface_name
    data_path: [basic]
    example: gre1
    test_value: '"gre1"'
    minimum_test_value: '"gre1"'
  - model_name: description
    tf_name: interface_description
    data_path: [basic]
    example: gre1
  - model_name: address
    tf_name: ipv4_address
    data_path: [basic, address]
    example: 70.1.1.1
    test_value: '"70.1.1.1"'
    minimum_test_value: '"70.1.1.1"'
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: mask
    tf_name: ipv4_subnet_mask
    data_path: [basic, address]
    example: 255.255.255.0
    test_value: '"255.255.255.0"'
    minimum_test_value: '"255.255.255.0"'
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: ipv6Address
    data_path: [basic]
    example: 2001:0:0:1::1/64
    exclude_test: true
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv6
  - model_name: shutdown
    data_path: [basic]
    example: true
  - model_name: multiplexing
    data_path: [basic]
    example: true
  - model_name: tunnelProtection
    data_path: [basic]
    example: false
  - model_name: tunnelMode
    data_path: [basic]
    example: ipv4
  - model_name: tunnelSource
    tf_name: tunnel_source_ipv4_address
    data_path: [basic, tunnelSourceType, sourceIp]
    example: 78.1.1.1
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelRouteVia
    tf_name: tunnel_route_via_ipv4_address
    data_path: [basic, tunnelSourceType, sourceIp]
    exclude_test: true
    example: 78.1.1.2
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelSourceInterface
    tf_name: tunnel_source_interface
    data_path: [basic, tunnelSourceType, sourceNotLoopback]
    exclude_test: true
    example: INTERFACE_1
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelRouteVia
    tf_name: tunnel_route_via_interface
    data_path: [basic, tunnelSourceType, sourceNotLoopback]
    exclude_test: true
    example: INTERFACE_2
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelSourceInterface
    tf_name: tunnel_source_interface_loopback
    data_path: [basic, tunnelSourceType, sourceLoopback]
    exclude_test: true
    example: LOOPBACK_1
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelRouteVia
    tf_name: tunnel_route_via_loopback
    data_path: [basic, tunnelSourceType, sourceLoopback]
    exclude_test: true
    example: LOOPBACK_2
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelSourceV6
    tf_name: tunnel_source_ipv6_address
    data_path: [basic, tunnelSourceType, sourceIpv6]
    exclude_test: true
    example: 2001:0:0:1::0
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv6
  - model_name: tunnelRouteVia
    tf_name: tunnel_route_via_ipv6_address
    data_path: [basic, tunnelSourceType, sourceIpv6]
    exclude_test: true
    example: 2001:0:0:2::0
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv6
  - model_name: tunnelDestination
    tf_name: tunnel_destination_ipv4_address
    data_path: [basic]
    example: 79.1.1.1
    test_value: '"79.1.1.1"'
    minimum_test_value: '"79.1.1.1"'
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tunnelDestinationV6
    tf_name: tunnel_destination_ipv6_address
    data_path: [basic]
    exclude_test: true
    example: 2001:0:0:3::0
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv6
  - model_name: mtu
    tf_name: ipv4_mtu
    data_path: [basic]
    example: 1500
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: mtuV6
    tf_name: ipv6_mtu
    data_path: [basic]
    exclude_test: true
    example: 1500
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv6
  - model_name: tcpMssAdjust
    tf_name: ipv4_tcp_mss
    data_path: [basic]
    example: 1460
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv4
  - model_name: tcpMssAdjustV6
    tf_name: ipv6_tcp_mss
    data_path: [basic]
    exclude_test: true
    example: 1460
    conditional_attribute:
      conditions:
        - name: tunnel_mode
          value: ipv6
  - model_name: clearDontFragment
    data_path: [basic]
    example: false
  - model_name: dpdInterval
    data_path: [basic]
    example: 10
  - model_name: dpdRetries
    data_path: [basic]
    example: 3
  - model_name: ikeVersion
    data_path: [basic]
    example: 1
  - model_name: ikeMode
    data_path: [basic]
    example: main
  - model_name: ikeRekeyInterval
    data_path: [basic]
    example: 14400
  - model_name: ikeCiphersuite
    data_path: [basic]
    example: aes256-cbc-sha1
  - model_name: ikeGroup
    data_path: [basic]
    example: 16
  - model_name: preSharedSecret
    data_path: [basic]
    example: 123
  - model_name: ikeLocalId
    data_path: [basic]
    example: xxx
  - model_name: ikeRemoteId
    data_path: [basic]
    example: xxx
  - model_name: ipsecRekeyInterval
    data_path: [basic]
    example: 3600
  - model_name: ipsecReplayWindow
    data_path: [basic]
    example: 512
  - model_name: ipsecCiphersuite
    data_path: [basic]
    example: aes256-gcm
  - model_name: perfectForwardSecrecy
    data_path: [basic]
    example: group-16
  - model_name: application
    tf_name: application_tunnel_type
    data_path: [advanced]
    example: none

test_prerequisites: |
  resource "sdwan_transport_feature_profile" "test" {
    name        = "TF_TEST"
    description = "Terraform test"
  }

  resource "sdwan_transport_wan_vpn_feature" "test" {
    name                       = "TF_TEST_WAN"
    description                = "Terraform test"
    feature_profile_id         = sdwan_transport_feature_profile.test.id
    vpn                        = 0
    enhance_ecmp_keying        = true
    primary_dns_address_ipv4   = "1.2.3.4"
    secondary_dns_address_ipv4 = "2.3.4.5"
    primary_dns_address_ipv6   = "2001:0:0:1::0"
    secondary_dns_address_ipv6 = "2001:0:0:2::0"
    new_host_mappings = [
      {
        host_name            = "example"
        list_of_ip_addresses = ["1.2.3.4"]
      }
    ]
    ipv4_static_routes = [
      {
        network_address = "1.2.3.4"
        subnet_mask     = "0.0.0.0"
        gateway         = "nextHop"
        next_hops = [
          {
            address                 = "1.2.3.4"
            administrative_distance = 1
          }
        ]
      }
    ]
    ipv6_static_routes = [
      {
        prefix  = "2002::/16"
        gateway = "nextHop"
        next_hops = [
          {
            address                 = "2001:0:0:1::0"
            administrative_distance = 1
          }
        ]
      }
    ]
    services = [
      {
        service_type = "TE"
      }
    ]
    nat_64_v4_pools = [
      {
        nat64_v4_pool_name        = "example"
        nat64_v4_pool_range_start = "203.0.113.50"
        nat64_v4_pool_range_end   = "203.0.113.100"
        nat64_v4_pool_overload    = false
      }
    ]
  }
