---
name: Policy Object Unified Advanced Malware Protection
rest_endpoint: /v1/feature-profile/sdwan/policy-object/%v/unified/advanced-malware-protection
minimum_version: 20.12.0
test_tags: [SDWAN_2012]
skip_minimum_test: true
parcel_type: policy_object
attributes:
  - tf_name: feature_profile_id
    reference: true
    type: String
    mandatory: true
    description: Feature Profile ID
    example: f6dd22c8-0b4f-496c-9a0b-6813d1f8b8ac
    test_value: sdwan_policy_object_feature_profile.test.id
  - model_name: matchAllVpn
    tf_name: match_all_vpn
    value: true
    value_type: "global"
    example: true
  - model_name: fileReputationCloudServer
    tf_name: amp_cloud_region
    mandatory: true
    example: nam
  - model_name: fileReputationEstServer
    tf_name: amp_cloud_region_est_server
    mandatory: true
    example: nam
  - model_name: fileReputationAlert
    tf_name: alert_log_level
    mandatory: true
    example: critical
  - model_name: fileAnalysisEnabled
    tf_name: file_analysis
    mandatory: true
    example: true
  - model_name: fileAnalysisCloudServer
    tf_name: file_analysis_cloud_region
    ignore_mandatory: true
    conditional_attribute:
      name: file_analysis
      value: true
      type: Bool
    example: nam
  - model_name: fileAnalysisFileTypes
    tf_name: file_analysis_file_types
    ignore_mandatory: true
    conditional_attribute:
      name: file_analysis
      value: true
      type: Bool
    example: pdf
  - model_name: fileAnalysisAlert
    tf_name: file_analysis_alert_log_level
    ignore_mandatory: true
    conditional_attribute:
      name: file_analysis
      value: true
      type: Bool
    example: critical

test_prerequisites: |
  resource "sdwan_policy_object_feature_profile" "test" {
    name = "POLICY_OBJECT_FP_1"
    description = "My policy object feature profile 1"
  }
